<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é›»å‹•è…³è¸è»Šé€šè·¯å•†åˆä½œå°ˆæ¡ˆé€±å ±</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f5f5f5;
        }
        .header {
            background-color: #4472C4;
            color: white;
            padding: 15px;
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 20px;
        }
        .editable {
            background-color: transparent;
            border: none;
            font-family: inherit;
            font-size: inherit;
            font-weight: inherit;
            color: inherit;
            width: 100%;
            padding: 2px;
            outline: none;
        }
        .editable:focus {
            background-color: rgba(255, 255, 255, 0.3);
            border: 1px solid #fff;
        }
        td .editable {
            background-color: transparent;
            color: inherit;
        }
        td .editable:focus {
            background-color: rgba(68, 114, 196, 0.1);
            border: 1px solid #4472C4;
        }
        textarea.editable {
            font-family: inherit;
            font-size: inherit;
            line-height: 1.4;
        }
        .container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }
        .section {
            background-color: white;
            border: 2px solid #ddd;
            border-radius: 8px;
            padding: 15px;
        }
        .section-title {
            background-color: #E7F3FF;
            color: #4472C4;
            font-weight: bold;
            padding: 8px;
            margin: -15px -15px 15px -15px;
            border-radius: 5px 5px 0 0;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }
        th {
            background-color: #f0f0f0;
            font-weight: bold;
        }
        .status-green {
            background-color: #92D050;
            border-radius: 50%;
            width: 15px;
            height: 15px;
            display: inline-block;
        }
        .status-yellow {
            background-color: #FFC000;
            border-radius: 50%;
            width: 15px;
            height: 15px;
            display: inline-block;
        }
        .status-red {
            background-color: #FF0000;
            border-radius: 50%;
            width: 15px;
            height: 15px;
            display: inline-block;
        }
        .checkmark {
            color: green;
            font-weight: bold;
        }
        .cross {
            color: red;
            font-weight: bold;
        }
        .timeline {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 20px 0;
        }
        .phase {
            text-align: center;
            flex: 1;
        }
        .phase-circle {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            margin: 0 auto 5px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }
        .phase-active {
            background-color: #4472C4;
        }
        .phase-completed {
            background-color: #92D050;
        }
        .phase-pending {
            background-color: #B0B0B0;
        }
        .footer {
            background: linear-gradient(90deg, #00CCCC, #0099CC);
            color: white;
            text-align: center;
            padding: 15px;
            font-size: 16px;
            font-weight: bold;
            font-style: italic;
            margin-top: 20px;
        }
        .full-width {
            grid-column: 1 / -1;
        }

        /* PDF åˆ—å°æ¨£å¼ */
        @media print {
            body {
                background-color: white !important;
                margin: 0;
                padding: 15px;
                font-size: 12px;
            }
            
            .backup-controls {
                display: none !important;
            }
            
            .header {
                background-color: #4472C4 !important;
                color: white !important;
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
            }
            
            .section {
                background-color: white !important;
                border: 1px solid #333 !important;
                page-break-inside: avoid;
                margin-bottom: 15px;
            }
            
            .section-title {
                background-color: #E7F3FF !important;
                color: #4472C4 !important;
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
            }
            
            .container {
                display: block !important;
            }
            
            .container .section {
                width: 48% !important;
                display: inline-block !important;
                vertical-align: top !important;
                margin-right: 2% !important;
            }
            
            .full-width {
                width: 100% !important;
                display: block !important;
                overflow: hidden !important;
                max-width: 100% !important;
            }
            
            table {
                border-collapse: collapse !important;
                width: 100% !important;
                page-break-inside: avoid !important;
                break-inside: avoid !important;
            }
            
            th, td {
                border: 1px solid #333 !important;
                padding: 6px !important;
                font-size: 11px !important;
                page-break-inside: avoid !important;
                break-inside: avoid !important;
            }
            
            tr {
                page-break-inside: avoid !important;
                break-inside: avoid !important;
            }
            
            th {
                background-color: #f0f0f0 !important;
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
            }
            
            .status-green, .status-yellow, .status-red {
                border: 1px solid #333 !important;
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
            }
            
            .timeline {
                display: flex !important;
                justify-content: space-between !important;
                page-break-inside: avoid !important;
                break-inside: avoid !important;
                width: 100% !important;
                max-width: 100% !important;
                overflow: hidden !important;
                flex-wrap: wrap !important;
                gap: 5px !important;
            }
            
            .phase {
                flex: 1 1 15% !important;
                text-align: center !important;
                min-width: 0 !important;
                max-width: 15% !important;
                padding: 0 1px !important;
                font-size: 8px !important;
            }
            
            .phase-circle {
                border: 1px solid #333 !important;
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
                width: 25px !important;
                height: 25px !important;
                font-size: 8px !important;
                margin: 0 auto 2px !important;
            }
            
            .footer {
                background: linear-gradient(90deg, #00CCCC, #0099CC) !important;
                color: white !important;
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
            }
            
            .phase input {
                font-size: 7px !important;
                max-width: 100% !important;
                text-align: center !important;
                padding: 1px !important;
                width: 100% !important;
                box-sizing: border-box !important;
            }
            
            input, textarea {
                border: none !important;
                background: transparent !important;
                outline: none !important;
                color: inherit !important;
            }
            
            /* ç¢ºä¿åˆ†é åˆç† */
            .section {
                page-break-inside: avoid;
            }
            
            h1, h2, h3 {
                page-break-after: avoid;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        ã€å°ˆæ¡ˆé€±å ±ã€‘<input type="text" class="editable" value="AMRå°ˆæ¡ˆé€²åº¦èˆ‡è³‡æºç®¡ç†æ©Ÿåˆ¶å»ºç½®" style="color: white;"> - <input type="text" class="editable" value="å°ˆæ¡ˆç®¡ç†éƒ¨" style="color: white; width: 100px;"> (<input type="text" class="editable" value="w31 2025.07.28-2025.08.01" style="color: white; width: 200px;">)
    </div>

    <div class="backup-controls">
        <button onclick="exportToMarkdown()">ğŸ“ åŒ¯å‡º Markdown</button>
        <button onclick="exportToPDF()">ğŸ“„ åŒ¯å‡º PDF</button>
        <label for="importFile">ğŸ“‚ åŒ¯å…¥ Markdown</label>
        <input type="file" id="importFile" accept=".md,.txt" onchange="importFromMarkdown(event)">
        <span class="backup-status" id="backupStatus">æº–å‚™å°±ç·’</span>
    </div>

    <div class="container">
        <div class="section">
            <div class="section-title">1.å°ˆæ¡ˆæ¦‚æ³</div>
            <table>
                <tr>
                    <td style="background-color: #f0f0f0; font-weight: bold;">å°ˆæ¡ˆåç¨±</td>
                    <td><input type="text" class="editable" value="AMRå°ˆæ¡ˆé€²åº¦èˆ‡è³‡æºç®¡ç†æ©Ÿåˆ¶å»ºç½®"></td>
                </tr>
                <tr>
                    <td style="background-color: #f0f0f0; font-weight: bold;">è² è²¬PM</td>
                    <td><input type="text" class="editable" value="å°ˆæ¡ˆç®¡ç†éƒ¨"></td>
                </tr>
                <tr>
                    <td style="background-color: #f0f0f0; font-weight: bold;">å°ˆæ¡ˆç‹€æ…‹</td>
                    <td>
                        <select class="editable" style="width: 100%; padding: 2px; border: none; background-color: transparent; font-family: inherit; font-size: inherit;">
                            <option value="PENDING" selected>è©•ä¼°ä¸­ï¼ˆPENDINGï¼‰</option>
                            <option value="ON-GOING">åŸ·è¡Œä¸­ï¼ˆON-GOINGï¼‰</option>
                            <option value="CLOSED">çµæ¡ˆï¼ˆCLOSEDï¼‰</option>
                            <option value="RESOURCE COORDINATION">è³‡æºå”èª¿ï¼ˆRESOURCE COORDINATIONï¼‰</option>
                        </select>
                    </td>
                </tr>
                <tr>
                    <td style="background-color: #f0f0f0; font-weight: bold;">éœ€æ±‚æè¿°</td>
                    <td><textarea class="editable" style="min-height: 80px; resize: vertical;" placeholder="è«‹æè¿°å°ˆæ¡ˆéœ€æ±‚ã€ç›®æ¨™èˆ‡é æœŸç”¢å‡ºï¼Œä»¥åˆ©åœ˜éšŠå°é½ŠåŸ·è¡Œæ–¹å‘">å»ºç«‹ä¸€å€‹æ©Ÿåˆ¶ä¾†ç®¡ç†AMRæ‰€æœ‰çš„å°ˆæ¡ˆé …ç›®ä¹‹é€²åº¦èˆ‡è³‡æºï¼Œç¢ºä¿å°ˆæ¡ˆå¯ä»¥å¦‚æœŸå¦‚å€¼å®Œæˆã€‚é€éç³»çµ±åŒ–çš„å°ˆæ¡ˆç›¤é»ï¼Œè¿½è¹¤æ¯å€‹å°ˆæ¡ˆçš„åŸ·è¡Œç‹€æ…‹ã€è³‡æºéœ€æ±‚åŠç”¢ç”Ÿæ•ˆç›Šã€‚å»ºç«‹æ¨™æº–åŒ–çš„å°ˆæ¡ˆç®¡ç†æµç¨‹ï¼Œæå‡æ•´é«”å°ˆæ¡ˆæˆåŠŸç‡èˆ‡è³‡æºä½¿ç”¨æ•ˆç‡ï¼Œä¸¦å»ºç«‹å¯è¦–åŒ–çš„å°ˆæ¡ˆå„€è¡¨æ¿ä¾›ç®¡ç†å±¤æ±ºç­–åƒè€ƒã€‚</textarea></td>
                </tr>
                <tr>
                    <td style="background-color: #f0f0f0; font-weight: bold;">ç›¸é—œè³‡æ–™</td>
                    <td><input type="text" class="editable" value="å°ˆæ¡ˆç®¡ç†æ¨™æº–ä½œæ¥­ç¨‹åºã€è³‡æºåˆ†é…çŸ©é™£ã€æ•ˆç›Šè©•ä¼°è¡¨"></td>
                </tr>
            </table>
        </div>

        <div class="section">
            <div class="section-title" style="display: flex; justify-content: space-between; align-items: center;">
                2.é¢¨éšªç®¡ç†
                <button id="addRiskRow" style="background-color: #4472C4; color: white; border: none; padding: 5px 10px; border-radius: 3px; cursor: pointer; font-size: 12px;">æ–°å¢</button>
            </div>
            <table id="riskTable">
                <tr>
                    <th style="width: 40px;"></th>
                    <th>é¢¨éšªè­˜é¡Œ</th>
                    <th style="width: 70px;">å½±éŸ¿ç¨‹åº¦</th>
                    <th>æè§£æªæ–½</th>
                    <th style="width: 80px;">è² è²¬äºº</th>
                    <th>ç›®æ¨™å®Œæˆæ™‚é–“</th>
                </tr>
                <tr>
                    <td style="text-align: center;">
                        <button class="delete-risk-row" style="background-color: #ff4444; color: white; border: none; border-radius: 50%; width: 20px; height: 20px; cursor: pointer; font-size: 12px; font-weight: bold;">-</button>
                    </td>
                    <td><input type="text" class="editable" value="å„éƒ¨é–€é…åˆåº¦ä¸è¶³"></td>
                    <td>
                        <select class="editable" style="width: 100%; padding: 2px; border: none; background-color: transparent; font-family: inherit; font-size: inherit;">
                            <option value="RED">ç·Šæ€¥</option>
                            <option value="ORANGE">é¢¨éšª</option>
                            <option value="GREEN" selected>ä¸€èˆ¬</option>
                        </select>
                    </td>
                    <td><input type="text" class="editable" value="å»ºç«‹é«˜å±¤æ”¯æŒèˆ‡æ¿€å‹µæ©Ÿåˆ¶"></td>
                    <td><input type="text" class="editable" value="å°ˆæ¡ˆç®¡ç†éƒ¨"></td>
                    <td><input type="text" class="editable" value="8æœˆä¸­æ—¬å®Œæˆ"></td>
                </tr>
                <tr>
                    <td style="text-align: center;">
                        <button class="delete-risk-row" style="background-color: #ff4444; color: white; border: none; border-radius: 50%; width: 20px; height: 20px; cursor: pointer; font-size: 12px; font-weight: bold;">-</button>
                    </td>
                    <td><input type="text" class="editable" value="ç³»çµ±æ•´åˆè¤‡é›œåº¦é«˜"></td>
                    <td>
                        <select class="editable" style="width: 100%; padding: 2px; border: none; background-color: transparent; font-family: inherit; font-size: inherit;">
                            <option value="RED">ç·Šæ€¥</option>
                            <option value="ORANGE">é¢¨éšª</option>
                            <option value="GREEN" selected>ä¸€èˆ¬</option>
                        </select>
                    </td>
                    <td><input type="text" class="editable" value="åˆ†éšæ®µå°å…¥èˆ‡æ¸¬è©¦é©—è­‰"></td>
                    <td><input type="text" class="editable" value="ITéƒ¨é–€"></td>
                    <td><input type="text" class="editable" value="9æœˆåº•å‰é©—è­‰"></td>
                </tr>
                <tr>
                    <td style="text-align: center;">
                        <button class="delete-risk-row" style="background-color: #ff4444; color: white; border: none; border-radius: 50%; width: 20px; height: 20px; cursor: pointer; font-size: 12px; font-weight: bold;">-</button>
                    </td>
                    <td><input type="text" class="editable" value="è³‡æ–™å“è³ªèˆ‡ä¸€è‡´æ€§"></td>
                    <td>
                        <select class="editable" style="width: 100%; padding: 2px; border: none; background-color: transparent; font-family: inherit; font-size: inherit;">
                            <option value="RED">ç·Šæ€¥</option>
                            <option value="ORANGE">é¢¨éšª</option>
                            <option value="GREEN" selected>ä¸€èˆ¬</option>
                        </select>
                    </td>
                    <td><input type="text" class="editable" value="å»ºç«‹è³‡æ–™æ¨™æº–åŒ–æµç¨‹"></td>
                    <td><input type="text" class="editable" value="å„å°ˆæ¡ˆè² è²¬äºº"></td>
                    <td><input type="text" class="editable" value="æŒçºŒé€²è¡Œ"></td>
                </tr>
            </table>
        </div>
    </div>

    <div class="container">
        <div class="section">
            <div class="section-title">3.é‡è¦é€²åº¦ / é€²åº¦æ›´æ–°</div>
            <div style="margin-top: 15px;">
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <span><span class="checkmark">âœ“</span> æœ¬é€±å®Œæˆäº‹é …</span>
                    <button id="addCompletedItem" style="background-color: #4472C4; color: white; border: none; padding: 5px 10px; border-radius: 3px; cursor: pointer; font-size: 12px;">æ–°å¢</button>
                </div>
                <div id="completedItemsContainer" style="margin-left: 20px; margin-top: 5px;">
                    <div style="display: flex; align-items: center; margin-bottom: 5px;">
                        <span class="checkmark" style="margin-right: 8px;">âœ“</span>
                        <input type="text" class="editable" value="å®Œæˆç¾æœ‰å°ˆæ¡ˆæ¸…å–®ç›¤é»" style="flex: 1; border: 1px solid #ccc; border-radius: 3px; padding: 4px;">
                        <button class="delete-completed-item" style="background-color: #ff4444; color: white; border: none; border-radius: 50%; width: 20px; height: 20px; cursor: pointer; font-size: 12px; font-weight: bold; margin-left: 8px;">-</button>
                    </div>
                    <div style="display: flex; align-items: center; margin-bottom: 5px;">
                        <span class="checkmark" style="margin-right: 8px;">âœ“</span>
                        <input type="text" class="editable" value="å»ºç«‹å°ˆæ¡ˆåˆ†é¡èˆ‡å„ªå…ˆç´šå®šç¾©" style="flex: 1; border: 1px solid #ccc; border-radius: 3px; padding: 4px;">
                        <button class="delete-completed-item" style="background-color: #ff4444; color: white; border: none; border-radius: 50%; width: 20px; height: 20px; cursor: pointer; font-size: 12px; font-weight: bold; margin-left: 8px;">-</button>
                    </div>
                    <div style="display: flex; align-items: center; margin-bottom: 5px;">
                        <span class="checkmark" style="margin-right: 8px;">âœ“</span>
                        <input type="text" class="editable" value="åˆ¶å®šå°ˆæ¡ˆç®¡ç†æ¨™æº–ä½œæ¥­ç¨‹åºåˆç¨¿" style="flex: 1; border: 1px solid #ccc; border-radius: 3px; padding: 4px;">
                        <button class="delete-completed-item" style="background-color: #ff4444; color: white; border: none; border-radius: 50%; width: 20px; height: 20px; cursor: pointer; font-size: 12px; font-weight: bold; margin-left: 8px;">-</button>
                    </div>
                    <div style="display: flex; align-items: center; margin-bottom: 5px;">
                        <span class="checkmark" style="margin-right: 8px;">âœ“</span>
                        <input type="text" class="editable" value="" style="flex: 1; border: 1px solid #ccc; border-radius: 3px; padding: 4px;">
                        <button class="delete-completed-item" style="background-color: #ff4444; color: white; border: none; border-radius: 50%; width: 20px; height: 20px; cursor: pointer; font-size: 12px; font-weight: bold; margin-left: 8px;">-</button>
                    </div>
                </div>
                
                <div style="margin-top: 15px; display: flex; justify-content: space-between; align-items: center;">
                    <span><span class="cross">âœ—</span> ä¸‹é€±é‡é»äº‹é …</span>
                    <button id="addTodoItem" style="background-color: #4472C4; color: white; border: none; padding: 5px 10px; border-radius: 3px; cursor: pointer; font-size: 12px;">æ–°å¢</button>
                </div>
                <div id="todoItemsContainer" style="margin-left: 20px; margin-top: 5px;">
                    <div style="display: flex; align-items: center; margin-bottom: 5px;">
                        <span class="cross" style="margin-right: 8px;">âœ—</span>
                        <input type="text" class="editable" value="è¨­è¨ˆå°ˆæ¡ˆç®¡ç†å„€è¡¨æ¿æ¶æ§‹" style="flex: 1; border: 1px solid #ccc; border-radius: 3px; padding: 4px;">
                        <button class="delete-todo-item" style="background-color: #ff4444; color: white; border: none; border-radius: 50%; width: 20px; height: 20px; cursor: pointer; font-size: 12px; font-weight: bold; margin-left: 8px;">-</button>
                    </div>
                    <div style="display: flex; align-items: center; margin-bottom: 5px;">
                        <span class="cross" style="margin-right: 8px;">âœ—</span>
                        <input type="text" class="editable" value="å»ºç«‹è³‡æºéœ€æ±‚è©•ä¼°æ¨¡å‹" style="flex: 1; border: 1px solid #ccc; border-radius: 3px; padding: 4px;">
                        <button class="delete-todo-item" style="background-color: #ff4444; color: white; border: none; border-radius: 50%; width: 20px; height: 20px; cursor: pointer; font-size: 12px; font-weight: bold; margin-left: 8px;">-</button>
                    </div>
                    <div style="display: flex; align-items: center; margin-bottom: 5px;">
                        <span class="cross" style="margin-right: 8px;">âœ—</span>
                        <input type="text" class="editable" value="è¦åŠƒæ•ˆç›Šè¡¡é‡æŒ‡æ¨™èˆ‡KPI" style="flex: 1; border: 1px solid #ccc; border-radius: 3px; padding: 4px;">
                        <button class="delete-todo-item" style="background-color: #ff4444; color: white; border: none; border-radius: 50%; width: 20px; height: 20px; cursor: pointer; font-size: 12px; font-weight: bold; margin-left: 8px;">-</button>
                    </div>
                    <div style="display: flex; align-items: center; margin-bottom: 5px;">
                        <span class="cross" style="margin-right: 8px;">âœ—</span>
                        <input type="text" class="editable" value="å•Ÿå‹•è·¨éƒ¨é–€å”ä½œæ©Ÿåˆ¶å»ºç«‹" style="flex: 1; border: 1px solid #ccc; border-radius: 3px; padding: 4px;">
                        <button class="delete-todo-item" style="background-color: #ff4444; color: white; border: none; border-radius: 50%; width: 20px; height: 20px; cursor: pointer; font-size: 12px; font-weight: bold; margin-left: 8px;">-</button>
                    </div>
                </div>
            </div>
        </div>

        <div class="section">
            <div class="section-title">4.é—œéµ NPI</div>
            <table id="npiTable">
                <tr>
                    <th style="width: 80px;">NPIéšæ®µ</th>
                    <th>Milestone</th>
                    <th>Support</th>
                    <th style="width: 60px;">SPI</th>
                    <th style="width: 80px;">ç‹€æ…‹</th>
                </tr>
                <tr>
                    <td><input type="text" class="editable" value="C0"></td>
                    <td><input type="text" class="editable" value="å°ˆæ¡ˆç›¤é»èˆ‡éœ€æ±‚ç¢ºèª"></td>
                    <td><input type="text" class="editable" value="PM"></td>
                    <td><input type="text" class="editable" value="0.9"></td>
                    <td>
                        <select class="editable" style="width: 100%; padding: 2px; border: none; background-color: transparent; font-family: inherit; font-size: inherit;">
                            <option value="GREEN" selected>ğŸŸ¢</option>
                            <option value="YELLOW">ğŸŸ¡</option>
                            <option value="RED">ğŸ”´</option>
                        </select>
                    </td>
                </tr>
                <tr>
                    <td><input type="text" class="editable" value="C1"></td>
                    <td><input type="text" class="editable" value="ç®¡ç†æ©Ÿåˆ¶è¨­è¨ˆèˆ‡é©—è­‰"></td>
                    <td><input type="text" class="editable" value="PM"></td>
                    <td><input type="text" class="editable" value="0.3"></td>
                    <td>
                        <select class="editable" style="width: 100%; padding: 2px; border: none; background-color: transparent; font-family: inherit; font-size: inherit;">
                            <option value="GREEN">ğŸŸ¢</option>
                            <option value="YELLOW" selected>ğŸŸ¡</option>
                            <option value="RED">ğŸ”´</option>
                        </select>
                    </td>
                </tr>
                <tr>
                    <td><input type="text" class="editable" value="C2"></td>
                    <td><input type="text" class="editable" value="ç³»çµ±å¹³å°å»ºç½®èˆ‡æ¸¬è©¦"></td>
                    <td><input type="text" class="editable" value="ITéƒ¨é–€"></td>
                    <td><input type="text" class="editable" value="0.1"></td>
                    <td>
                        <select class="editable" style="width: 100%; padding: 2px; border: none; background-color: transparent; font-family: inherit; font-size: inherit;">
                            <option value="GREEN">ğŸŸ¢</option>
                            <option value="YELLOW">ğŸŸ¡</option>
                            <option value="RED" selected>ğŸ”´</option>
                        </select>
                    </td>
                </tr>
                <tr>
                    <td><input type="text" class="editable" value="C3"></td>
                    <td><input type="text" class="editable" value="è©¦ç‡Ÿé‹èˆ‡æˆæ•ˆé©—è­‰"></td>
                    <td><input type="text" class="editable" value="PM"></td>
                    <td><input type="text" class="editable" value="0"></td>
                    <td>
                        <select class="editable" style="width: 100%; padding: 2px; border: none; background-color: transparent; font-family: inherit; font-size: inherit;">
                            <option value="GREEN">ğŸŸ¢</option>
                            <option value="YELLOW">ğŸŸ¡</option>
                            <option value="RED" selected>ğŸ”´</option>
                        </select>
                    </td>
                </tr>
                <tr>
                    <td><input type="text" class="editable" value="C4"></td>
                    <td><input type="text" class="editable" value=""></td>
                    <td><input type="text" class="editable" value=""></td>
                    <td><input type="text" class="editable" value=""></td>
                    <td>
                        <select class="editable" style="width: 100%; padding: 2px; border: none; background-color: transparent; font-family: inherit; font-size: inherit;">
                            <option value="GREEN" selected>ğŸŸ¢</option>
                            <option value="YELLOW">ğŸŸ¡</option>
                            <option value="RED">ğŸ”´</option>
                        </select>
                    </td>
                </tr>
                <tr>
                    <td><input type="text" class="editable" value="C5"></td>
                    <td><input type="text" class="editable" value=""></td>
                    <td><input type="text" class="editable" value=""></td>
                    <td><input type="text" class="editable" value=""></td>
                    <td>
                        <select class="editable" style="width: 100%; padding: 2px; border: none; background-color: transparent; font-family: inherit; font-size: inherit;">
                            <option value="GREEN" selected>ğŸŸ¢</option>
                            <option value="YELLOW">ğŸŸ¡</option>
                            <option value="RED">ğŸ”´</option>
                        </select>
                    </td>
                </tr>
            </table>
        </div>
    </div>

    <div class="section full-width">
        <div class="section-title">5.é–‹ç™¼éšæ®µç‹€æ…‹</div>
        <div class="timeline">
            <div class="phase">
                <div class="phase-circle phase-completed"><input type="text" class="editable" value="C0" style="background:transparent; color:white; border:none; text-align:center; width:20px;"></div>
                <div><strong><input type="text" class="editable" value="Idea" style="font-weight:bold;"></strong></div>
                <div style="font-size: 12px;"><input type="text" class="editable" value="8/5" style="font-size:12px;"><br><input type="text" class="editable" value="å°ˆæ¡ˆç›¤é»å®Œæˆ" style="font-size:12px;"></div>
            </div>
            <div class="phase">
                <div class="phase-circle phase-active"><input type="text" class="editable" value="C1" style="background:transparent; color:white; border:none; text-align:center; width:20px;"></div>
                <div><strong><input type="text" class="editable" value="Plan" style="font-weight:bold;"></strong></div>
                <div style="font-size: 12px;"><input type="text" class="editable" value="8/20" style="font-size:12px;"><br><input type="text" class="editable" value="ç®¡ç†æ©Ÿåˆ¶è¨­è¨ˆ" style="font-size:12px;"></div>
            </div>
            <div class="phase">
                <div class="phase-circle phase-pending"><input type="text" class="editable" value="C2" style="background:transparent; color:white; border:none; text-align:center; width:20px;"></div>
                <div><strong><input type="text" class="editable" value="EVT" style="font-weight:bold;"></strong></div>
                <div style="font-size: 12px;"><input type="text" class="editable" value="9/15" style="font-size:12px;"><br><input type="text" class="editable" value="ç³»çµ±å¹³å°å»ºç½®" style="font-size:12px;"></div>
            </div>
            <div class="phase">
                <div class="phase-circle phase-pending"><input type="text" class="editable" value="C3" style="background:transparent; color:white; border:none; text-align:center; width:20px;"></div>
                <div><strong><input type="text" class="editable" value="DVT" style="font-weight:bold;"></strong></div>
                <div style="font-size: 12px;"><input type="text" class="editable" value="10/1" style="font-size:12px;"><br><input type="text" class="editable" value="è©¦ç‡Ÿé‹é©—è­‰" style="font-size:12px;"></div>
            </div>
            <div class="phase">
                <div class="phase-circle phase-pending"><input type="text" class="editable" value="C4" style="background:transparent; color:white; border:none; text-align:center; width:20px;"></div>
                <div><strong><input type="text" class="editable" value="PVT" style="font-weight:bold;"></strong></div>
                <div style="font-size: 12px;"><input type="text" class="editable" value="10/15" style="font-size:12px;"><br><input type="text" class="editable" value="æ•ˆæœè©•ä¼°å„ªåŒ–" style="font-size:12px;"></div>
            </div>
            <div class="phase">
                <div class="phase-circle phase-pending"><input type="text" class="editable" value="C5" style="background:transparent; color:white; border:none; text-align:center; width:20px;"></div>
                <div><strong><input type="text" class="editable" value="MP" style="font-weight:bold;"></strong></div>
                <div style="font-size: 12px;"><input type="text" class="editable" value="11/1" style="font-size:12px;"><br><input type="text" class="editable" value="æ­£å¼ä¸Šç·šæ¨å»£" style="font-size:12px;"></div>
            </div>
        </div>
    </div>

    <div class="section full-width">
        <div class="section-title" style="display: flex; justify-content: space-between; align-items: center;">
            6.ç®¡ç†å±¤æ±ºç­–éœ€æ±‚
            <button id="addDecisionRow" style="background-color: #4472C4; color: white; border: none; padding: 5px 10px; border-radius: 3px; cursor: pointer; font-size: 12px;">æ–°å¢</button>
        </div>
        <table id="decisionTable">
            <tr>
                <th style="width: 40px;"></th>
                <th style="width: 30%;">æ±ºç­–é …ç›®</th>
                <th style="width: 15%;">ç·Šæ€¥ç¨‹åº¦</th>
                <th style="width: 20%;">é æœŸæ±ºç­–æ™‚é–“</th>
                <th style="width: 35%;">ç›¸é—œå½±éŸ¿</th>
            </tr>
            <tr>
                <td style="text-align: center;">
                    <button class="delete-decision-row" style="background-color: #ff4444; color: white; border: none; border-radius: 50%; width: 20px; height: 20px; cursor: pointer; font-size: 12px; font-weight: bold;">-</button>
                </td>
                <td><input type="text" class="editable" value="å°ˆæ¡ˆç®¡ç†ç³»çµ±å¹³å°é¸å‹"></td>
                <td>
                    <select class="editable" style="width: 100%; padding: 2px; border: none; background-color: transparent; font-family: inherit; font-size: inherit;">
                        <option value="URGENT" selected>ç·Šæ€¥</option>
                        <option value="IMPORTANT">é‡è¦</option>
                        <option value="NORMAL">ä¸€èˆ¬</option>
                    </select>
                </td>
                <td><input type="text" class="editable" value="8æœˆ15æ—¥å‰"></td>
                <td><input type="text" class="editable" value="å½±éŸ¿å¾ŒçºŒç³»çµ±å»ºç½®æ™‚ç¨‹èˆ‡é ç®—"></td>
            </tr>
            <tr>
                <td style="text-align: center;">
                    <button class="delete-decision-row" style="background-color: #ff4444; color: white; border: none; border-radius: 50%; width: 20px; height: 20px; cursor: pointer; font-size: 12px; font-weight: bold;">-</button>
                </td>
                <td><input type="text" class="editable" value="è·¨éƒ¨é–€å”ä½œçå‹µæ©Ÿåˆ¶"></td>
                <td>
                    <select class="editable" style="width: 100%; padding: 2px; border: none; background-color: transparent; font-family: inherit; font-size: inherit;">
                        <option value="URGENT">ç·Šæ€¥</option>
                        <option value="IMPORTANT" selected>é‡è¦</option>
                        <option value="NORMAL">ä¸€èˆ¬</option>
                    </select>
                </td>
                <td><input type="text" class="editable" value="9æœˆ1æ—¥å‰"></td>
                <td><input type="text" class="editable" value="æ±ºå®šå„éƒ¨é–€åƒèˆ‡ç©æ¥µåº¦èˆ‡é…åˆåº¦"></td>
            </tr>
            <tr>
                <td style="text-align: center;">
                    <button class="delete-decision-row" style="background-color: #ff4444; color: white; border: none; border-radius: 50%; width: 20px; height: 20px; cursor: pointer; font-size: 12px; font-weight: bold;">-</button>
                </td>
                <td><input type="text" class="editable" value="å°ˆæ¡ˆåˆ†ç´šèˆ‡è³‡æºé…ç½®æ¨™æº–"></td>
                <td>
                    <select class="editable" style="width: 100%; padding: 2px; border: none; background-color: transparent; font-family: inherit; font-size: inherit;">
                        <option value="URGENT">ç·Šæ€¥</option>
                        <option value="IMPORTANT">é‡è¦</option>
                        <option value="NORMAL" selected>ä¸€èˆ¬</option>
                    </select>
                </td>
                <td><input type="text" class="editable" value="9æœˆ20æ—¥å‰"></td>
                <td><input type="text" class="editable" value="å½±éŸ¿è³‡æºåˆ†é…æ•ˆç‡èˆ‡å°ˆæ¡ˆå„ªå…ˆç´š"></td>
            </tr>
        </table>
    </div>

    <div class="footer">
        Innovate Today, Embrace Tomorrow
    </div>

    <script>
        // åŒ¯å‡ºç‚º PDF æ ¼å¼
        function exportToPDF() {
            updateStatus('ğŸ“„ æº–å‚™ç”Ÿæˆ PDF...');
            
            // ç­‰å¾…ä¸€å°æ®µæ™‚é–“è®“ç‹€æ…‹æ›´æ–°é¡¯ç¤º
            setTimeout(() => {
                // è§¸ç™¼ç€è¦½å™¨çš„åˆ—å°å°è©±æ¡†
                window.print();
                updateStatus('âœ… PDF åˆ—å°å°è©±æ¡†å·²é–‹å•Ÿ');
            }, 200);
        }

        // åŒ¯å‡ºç‚º Markdown æ ¼å¼
        function exportToMarkdown() {
            const data = collectFormData();
            const markdown = generateMarkdown(data);
            downloadMarkdown(markdown, `å°ˆæ¡ˆé€±å ±_${data.projectName}_${new Date().toISOString().slice(0, 10)}.md`);
            updateStatus('âœ… Markdown æª”æ¡ˆå·²åŒ¯å‡º');
        }

        // æ”¶é›†è¡¨å–®è³‡æ–™
        function collectFormData() {
            // å®‰å…¨å–å¾—å…ƒç´ å€¼çš„è¼”åŠ©å‡½æ•¸
            function safeGetValue(selector, defaultValue = '') {
                const element = document.querySelector(selector);
                return element ? element.value : defaultValue;
            }

            // æ”¶é›†æ¨™é¡Œè³‡è¨Š
            const headerInputs = document.querySelectorAll('.header input');
            const projectName = headerInputs[0] ? headerInputs[0].value : 'AMRå°ˆæ¡ˆé€²åº¦èˆ‡è³‡æºç®¡ç†æ©Ÿåˆ¶å»ºç½®';
            const projectManager = headerInputs[1] ? headerInputs[1].value : 'å°ˆæ¡ˆç®¡ç†éƒ¨';
            const period = headerInputs[2] ? headerInputs[2].value : 'w31 2025.07.28-2025.08.01';

            // æ”¶é›†å°ˆæ¡ˆæ¦‚æ³
            const overviewTable = document.querySelector('.section table');
            const overviewInputs = overviewTable ? overviewTable.querySelectorAll('input, textarea') : [];
            const projectDescription = document.querySelector('textarea') ? document.querySelector('textarea').value : '';
            const status = overviewInputs[2] ? overviewInputs[2].value : 'é€²è¡Œä¸­ (Plan)';
            const relatedDocs = overviewInputs[overviewInputs.length - 1] ? overviewInputs[overviewInputs.length - 1].value : '';

            return {
                projectName: projectName,
                projectManager: projectManager,
                period: period,
                projectDescription: projectDescription,
                status: status,
                relatedDocs: relatedDocs,
                
                // é¢¨éšªç®¡ç†
                risks: Array.from(document.querySelectorAll('#riskTable tr')).slice(1).map(row => {
                    const inputs = row.querySelectorAll('input');
                    const impactSelect = row.querySelector('select');
                    
                    const riskData = {
                        item: inputs[0] ? inputs[0].value : '',
                        impact: impactSelect ? impactSelect.options[impactSelect.selectedIndex]?.text || '' : '',
                        solution: inputs[1] ? inputs[1].value : '',
                        owner: inputs[2] ? inputs[2].value : '',
                        deadline: inputs[3] ? inputs[3].value : ''
                    };
                    return riskData;
                }).filter(risk => risk.item), // éæ¿¾ç©ºçš„é¢¨éšªé …ç›®
                
                // å®Œæˆäº‹é …
                completedItems: Array.from(document.querySelectorAll('.checkmark + input')).map(input => input.value).filter(item => item),
                
                // å¾…è¾¦äº‹é …
                todoItems: Array.from(document.querySelectorAll('.cross + input')).map(input => input.value).filter(item => item),
                
                // NPI éšæ®µ
                npiStages: Array.from(document.querySelectorAll('#npiTable tr')).slice(1).map(row => {
                    const inputs = row.querySelectorAll('input');
                    const statusSelect = row.querySelector('select');
                    return {
                        stage: inputs[0] ? inputs[0].value : '',
                        milestone: inputs[1] ? inputs[1].value : '',
                        owner: inputs[2] ? inputs[2].value : '',
                        spi: inputs[3] ? inputs[3].value : '',
                        status: statusSelect ? statusSelect.options[statusSelect.selectedIndex]?.text || '' : ''
                    };
                }).filter(stage => stage.stage), // éæ¿¾ç©ºçš„éšæ®µ
                
                // é–‹ç™¼éšæ®µ
                devPhases: Array.from(document.querySelectorAll('.phase')).map(phase => {
                    const inputs = phase.querySelectorAll('input');
                    return {
                        code: inputs[0] ? inputs[0].value : '',
                        name: inputs[1] ? inputs[1].value : '',
                        date: inputs[2] ? inputs[2].value : '',
                        description: inputs[3] ? inputs[3].value : ''
                    };
                }).filter(phase => phase.code), // éæ¿¾ç©ºçš„éšæ®µ
                
                // æ±ºç­–éœ€æ±‚
                decisions: Array.from(document.querySelectorAll('#decisionTable tr')).slice(1).map(row => {
                    const inputs = row.querySelectorAll('input');
                    const urgencySelect = row.querySelector('select');
                    
                    return {
                        item: inputs[0] ? inputs[0].value : '',
                        urgency: urgencySelect ? urgencySelect.options[urgencySelect.selectedIndex]?.text || '' : '',
                        deadline: inputs[1] ? inputs[1].value : '',
                        impact: inputs[2] ? inputs[2].value : ''
                    };
                }).filter(decision => decision.item) // éæ¿¾ç©ºçš„æ±ºç­–é …ç›®
            };
        }

        // ç”Ÿæˆ Markdown å…§å®¹
        function generateMarkdown(data) {
            return `# å°ˆæ¡ˆé€±å ±ï¼š${data.projectName}

**è² è²¬PMï¼š** ${data.projectManager}  
**é€±æœŸï¼š** ${data.period}  
**å°ˆæ¡ˆç‹€æ…‹ï¼š** ${data.status}

## å°ˆæ¡ˆæ¦‚æ³

### éœ€æ±‚æè¿°
${data.projectDescription}

### ç›¸é—œè³‡æ–™
${data.relatedDocs}

## é‡è¦é€²åº¦ / é€²åº¦æ›´æ–°

### âœ… æœ¬é€±å®Œæˆäº‹é …
${data.completedItems.map(item => `- ${item}`).join('\n')}

### ğŸ“‹ ä¸‹é€±é‡é»äº‹é …
${data.todoItems.map(item => `- ${item}`).join('\n')}

## é¢¨éšªç®¡ç†

| é¢¨éšªè­˜é¡Œ | å½±éŸ¿ç¨‹åº¦ | æè§£æªæ–½ | è² è²¬äºº | ç›®æ¨™å®Œæˆæ™‚é–“ |
|---------|---------|---------|--------|-------------|
${data.risks.map(risk => `| ${risk.item} | ${risk.impact} | ${risk.solution} | ${risk.owner} | ${risk.deadline} |`).join('\n')}

## é—œéµ NPI

| NPIéšæ®µ | Milestone | Support | SPI | ç‹€æ…‹ |
|---------|-----------|---------|-----|------|
${data.npiStages.map(stage => `| ${stage.stage} | ${stage.milestone} | ${stage.owner} | ${stage.spi} | ${stage.status} |`).join('\n')}

## é–‹ç™¼éšæ®µç‹€æ…‹

${data.devPhases.map(phase => `### ${phase.code} - ${phase.name}
**æ—¥æœŸï¼š** ${phase.date}  
**æè¿°ï¼š** ${phase.description}`).join('\n\n')}

## ç®¡ç†å±¤æ±ºç­–éœ€æ±‚

| æ±ºç­–é …ç›® | ç·Šæ€¥ç¨‹åº¦ | é æœŸæ±ºç­–æ™‚é–“ | ç›¸é—œå½±éŸ¿ |
|---------|---------|-------------|----------|
${data.decisions.map(decision => `| ${decision.item} | ${decision.urgency} | ${decision.deadline} | ${decision.impact} |`).join('\n')}

---
*åŒ¯å‡ºæ™‚é–“ï¼š${new Date().toLocaleString('zh-TW')}*
`;
        }

        // ä¸‹è¼‰ Markdown æª”æ¡ˆ
        function downloadMarkdown(content, filename) {
            const blob = new Blob([content], { type: 'text/markdown;charset=utf-8' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = filename;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        // å¾ Markdown åŒ¯å…¥
        function importFromMarkdown(event) {
            const file = event.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const markdown = e.target.result;
                    const data = parseMarkdown(markdown);
                    populateForm(data);
                    updateStatus('âœ… Markdown æª”æ¡ˆå·²åŒ¯å…¥');
                } catch (error) {
                    updateStatus('âŒ åŒ¯å…¥å¤±æ•—ï¼šæª”æ¡ˆæ ¼å¼ä¸æ­£ç¢º');
                    console.error('Import error:', error);
                }
            };
            reader.readAsText(file, 'UTF-8');
        }

        // è§£æ Markdown å…§å®¹
        function parseMarkdown(markdown) {
            const data = {};
            
            // è§£ææ¨™é¡Œ
            const titleMatch = markdown.match(/# å°ˆæ¡ˆé€±å ±ï¼š(.+)/);
            if (titleMatch) data.projectName = titleMatch[1];
            
            // è§£æåŸºæœ¬è³‡è¨Š
            const pmMatch = markdown.match(/\*\*è² è²¬PMï¼š\*\* (.+)/);
            if (pmMatch) data.projectManager = pmMatch[1];
            
            const periodMatch = markdown.match(/\*\*é€±æœŸï¼š\*\* (.+)/);
            if (periodMatch) data.period = periodMatch[1];
            
            const statusMatch = markdown.match(/\*\*å°ˆæ¡ˆç‹€æ…‹ï¼š\*\* (.+)/);
            if (statusMatch) data.status = statusMatch[1];
            
            // è§£æéœ€æ±‚æè¿°
            const descMatch = markdown.match(/### éœ€æ±‚æè¿°\n([\s\S]*?)\n### ç›¸é—œè³‡æ–™/);
            if (descMatch) data.projectDescription = descMatch[1].trim();
            
            // è§£æç›¸é—œè³‡æ–™
            const docsMatch = markdown.match(/### ç›¸é—œè³‡æ–™\n(.+)/);
            if (docsMatch) data.relatedDocs = docsMatch[1];
            
            // è§£æå®Œæˆäº‹é …
            const completedMatch = markdown.match(/### âœ… æœ¬é€±å®Œæˆäº‹é …\n([\s\S]*?)\n### ğŸ“‹/);
            if (completedMatch) {
                data.completedItems = completedMatch[1].split('\n')
                    .filter(line => line.startsWith('- '))
                    .map(line => line.substring(2));
            }
            
            // è§£æå¾…è¾¦äº‹é …
            const todoMatch = markdown.match(/### ğŸ“‹ ä¸‹é€±é‡é»äº‹é …\n([\s\S]*?)\n## é¢¨éšªç®¡ç†/);
            if (todoMatch) {
                data.todoItems = todoMatch[1].split('\n')
                    .filter(line => line.startsWith('- '))
                    .map(line => line.substring(2));
            }
            
            return data;
        }

        // å¡«å…¥è¡¨å–®è³‡æ–™
        function populateForm(data) {
            // å®‰å…¨è¨­ç½®å…ƒç´ å€¼çš„è¼”åŠ©å‡½æ•¸
            function safeSetValue(selector, value) {
                const element = document.querySelector(selector);
                if (element && value) {
                    element.value = value;
                }
            }

            // å¡«å…¥æ¨™é¡Œè³‡è¨Š
            const headerInputs = document.querySelectorAll('.header input');
            if (headerInputs[0] && data.projectName) headerInputs[0].value = data.projectName;
            if (headerInputs[1] && data.projectManager) headerInputs[1].value = data.projectManager;
            if (headerInputs[2] && data.period) headerInputs[2].value = data.period;

            // å¡«å…¥å°ˆæ¡ˆæè¿°
            const textarea = document.querySelector('textarea');
            if (textarea && data.projectDescription) {
                textarea.value = data.projectDescription;
            }

            // å¡«å…¥å°ˆæ¡ˆç‹€æ…‹å’Œç›¸é—œè³‡æ–™
            const overviewTable = document.querySelector('.section table');
            if (overviewTable) {
                const overviewInputs = overviewTable.querySelectorAll('input');
                if (overviewInputs[2] && data.status) overviewInputs[2].value = data.status;
                if (overviewInputs[overviewInputs.length - 1] && data.relatedDocs) {
                    overviewInputs[overviewInputs.length - 1].value = data.relatedDocs;
                }
            }
            
            // å¡«å…¥å®Œæˆäº‹é …
            if (data.completedItems && data.completedItems.length > 0) {
                const completedInputs = document.querySelectorAll('.checkmark + input');
                data.completedItems.forEach((item, index) => {
                    if (completedInputs[index] && item) {
                        completedInputs[index].value = item;
                    }
                });
            }
            
            // å¡«å…¥å¾…è¾¦äº‹é …
            if (data.todoItems && data.todoItems.length > 0) {
                const todoInputs = document.querySelectorAll('.cross + input');
                data.todoItems.forEach((item, index) => {
                    if (todoInputs[index] && item) {
                        todoInputs[index].value = item;
                    }
                });
            }

            // å¡«å…¥é¢¨éšªç®¡ç†è³‡æ–™
            if (data.risks && data.risks.length > 0) {
                const riskRows = document.querySelectorAll('#riskTable tr');
                data.risks.forEach((risk, index) => {
                    const rowIndex = index + 1; // è·³éæ¨™é¡Œè¡Œ
                    if (riskRows[rowIndex]) {
                        const inputs = riskRows[rowIndex].querySelectorAll('input');
                        if (inputs[0] && risk.item) inputs[0].value = risk.item;
                        if (inputs[1] && risk.solution) inputs[1].value = risk.solution;
                        if (inputs[2] && risk.owner) inputs[2].value = risk.owner;
                        if (inputs[3] && risk.deadline) inputs[3].value = risk.deadline;
                    }
                });
            }
        }

        // æ›´æ–°ç‹€æ…‹é¡¯ç¤º
        function updateStatus(message) {
            const status = document.getElementById('backupStatus');
            status.textContent = message;
            setTimeout(() => {
                status.textContent = 'æº–å‚™å°±ç·’';
            }, 3000);
        }

        // æ–°å¢é¢¨éšªç®¡ç†è¡ŒåŠŸèƒ½
        document.addEventListener('DOMContentLoaded', function() {
            const addRiskButton = document.getElementById('addRiskRow');
            const riskTable = document.getElementById('riskTable');
            
            addRiskButton.addEventListener('click', function() {
                const newRow = document.createElement('tr');
                newRow.innerHTML = `
                    <td style="text-align: center;">
                        <button class="delete-risk-row" style="background-color: #ff4444; color: white; border: none; border-radius: 50%; width: 20px; height: 20px; cursor: pointer; font-size: 12px; font-weight: bold;">-</button>
                    </td>
                    <td><input type="text" class="editable" value=""></td>
                    <td>
                        <select class="editable" style="width: 100%; padding: 2px; border: none; background-color: transparent; font-family: inherit; font-size: inherit;">
                            <option value="RED">ç·Šæ€¥</option>
                            <option value="ORANGE">é¢¨éšª</option>
                            <option value="GREEN" selected>ä¸€èˆ¬</option>
                        </select>
                    </td>
                    <td><input type="text" class="editable" value=""></td>
                    <td><input type="text" class="editable" value=""></td>
                    <td><input type="text" class="editable" value=""></td>
                `;
                riskTable.appendChild(newRow);
            });

            // åˆªé™¤é¢¨éšªç®¡ç†è¡ŒåŠŸèƒ½
            riskTable.addEventListener('click', function(e) {
                if (e.target.classList.contains('delete-risk-row')) {
                    if (confirm('ç¢ºå®šè¦åˆªé™¤é€™ä¸€è¡Œå—ï¼Ÿ')) {
                        e.target.closest('tr').remove();
                    }
                }
            });

            // æ–°å¢æœ¬é€±å®Œæˆäº‹é …åŠŸèƒ½
            const addCompletedButton = document.getElementById('addCompletedItem');
            const completedContainer = document.getElementById('completedItemsContainer');
            
            addCompletedButton.addEventListener('click', function() {
                const newItem = document.createElement('div');
                newItem.style.display = 'flex';
                newItem.style.alignItems = 'center';
                newItem.style.marginBottom = '5px';
                newItem.innerHTML = `
                    <span class="checkmark" style="margin-right: 8px;">âœ“</span>
                    <input type="text" class="editable" value="" style="flex: 1; border: 1px solid #ccc; border-radius: 3px; padding: 4px;">
                    <button class="delete-completed-item" style="background-color: #ff4444; color: white; border: none; border-radius: 50%; width: 20px; height: 20px; cursor: pointer; font-size: 12px; font-weight: bold; margin-left: 8px;">-</button>
                `;
                completedContainer.appendChild(newItem);
            });

            // æ–°å¢ä¸‹é€±é‡é»äº‹é …åŠŸèƒ½
            const addTodoButton = document.getElementById('addTodoItem');
            const todoContainer = document.getElementById('todoItemsContainer');
            
            addTodoButton.addEventListener('click', function() {
                const newItem = document.createElement('div');
                newItem.style.display = 'flex';
                newItem.style.alignItems = 'center';
                newItem.style.marginBottom = '5px';
                newItem.innerHTML = `
                    <span class="cross" style="margin-right: 8px;">âœ—</span>
                    <input type="text" class="editable" value="" style="flex: 1; border: 1px solid #ccc; border-radius: 3px; padding: 4px;">
                    <button class="delete-todo-item" style="background-color: #ff4444; color: white; border: none; border-radius: 50%; width: 20px; height: 20px; cursor: pointer; font-size: 12px; font-weight: bold; margin-left: 8px;">-</button>
                `;
                todoContainer.appendChild(newItem);
            });

            // åˆªé™¤æœ¬é€±å®Œæˆäº‹é …åŠŸèƒ½
            completedContainer.addEventListener('click', function(e) {
                if (e.target.classList.contains('delete-completed-item')) {
                    if (confirm('ç¢ºå®šè¦åˆªé™¤é€™å€‹å®Œæˆäº‹é …å—ï¼Ÿ')) {
                        e.target.closest('div').remove();
                    }
                }
            });

            // åˆªé™¤ä¸‹é€±é‡é»äº‹é …åŠŸèƒ½
            todoContainer.addEventListener('click', function(e) {
                if (e.target.classList.contains('delete-todo-item')) {
                    if (confirm('ç¢ºå®šè¦åˆªé™¤é€™å€‹é‡é»äº‹é …å—ï¼Ÿ')) {
                        e.target.closest('div').remove();
                    }
                }
            });

            // æ–°å¢ç®¡ç†å±¤æ±ºç­–éœ€æ±‚åŠŸèƒ½
            const addDecisionButton = document.getElementById('addDecisionRow');
            const decisionTable = document.getElementById('decisionTable');
            
            addDecisionButton.addEventListener('click', function() {
                const newRow = document.createElement('tr');
                newRow.innerHTML = `
                    <td style="text-align: center;">
                        <button class="delete-decision-row" style="background-color: #ff4444; color: white; border: none; border-radius: 50%; width: 20px; height: 20px; cursor: pointer; font-size: 12px; font-weight: bold;">-</button>
                    </td>
                    <td><input type="text" class="editable" value=""></td>
                    <td>
                        <select class="editable" style="width: 100%; padding: 2px; border: none; background-color: transparent; font-family: inherit; font-size: inherit;">
                            <option value="URGENT">ç·Šæ€¥</option>
                            <option value="IMPORTANT">é‡è¦</option>
                            <option value="NORMAL" selected>ä¸€èˆ¬</option>
                        </select>
                    </td>
                    <td><input type="text" class="editable" value=""></td>
                    <td><input type="text" class="editable" value=""></td>
                `;
                decisionTable.appendChild(newRow);
            });

            // åˆªé™¤ç®¡ç†å±¤æ±ºç­–éœ€æ±‚åŠŸèƒ½
            decisionTable.addEventListener('click', function(e) {
                if (e.target.classList.contains('delete-decision-row')) {
                    if (confirm('ç¢ºå®šè¦åˆªé™¤é€™å€‹æ±ºç­–éœ€æ±‚å—ï¼Ÿ')) {
                        e.target.closest('tr').remove();
                    }
                }
            });
        });
    </script>
</body>
</html>